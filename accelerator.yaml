accelerator:
  displayName: New Accelerator
  description: Generate yaml for a new Accelerator resource.
  iconUrl: https://raw.githubusercontent.com/simple-starters/icons/master/icon-tanzu-light.png
  tags:
    - Tanzu
    - Accelerator
  options:
    - name: acceleratorName
      label: Name of Accelerator
      required: true

    - name: gitUrl
      label: Git Repository URL
      required: true

    - name: gitBranch
      label: Git Branch
      required: true
      defaultValue: main

    - name: tags
      label: Tags
      inputType: tag
      dataType: [string]
      defaultValue: []
      display: true

    - name: icon
      label: Icon URL
      defaultValue: https://raw.githubusercontent.com/simple-starters/icons/master/icon-tanzu-light.png

engine:
  merge:
    - include: ["*.yaml"]
      chain:
      - type: YTT
      - merge:
        - include: ["k8s-resource.yaml"]
          chain:
          - type: RewritePath
            rewriteTo: "'kubernetes/' + #acceleratorName + '.yaml'"
        - include: ["new-accelerator.yaml"]
          chain:
          - type: RewritePath
            rewriteTo: "'accelerator.yaml'"
    - include: [README.md]
      chain:
      - type: ReplaceText
        substitutions:
        - text: k8s-resource
          with: "'kubernetes/' + #acceleratorName"
